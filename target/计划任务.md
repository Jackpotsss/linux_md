# 计划任务

计划任务又叫定时任务，计划任务分为两种，一种是仅执行一次就结束的任务；另一种是周期性的循环执行。

at 命令用于执行一次性定时任务，atd 提供服务；

crontab 命令用于执行周期性定时任务，crond 提供服务；

```shell
# 一次性定时任务
at 
# 周期性定时任务
crontab
```



## 一次性计划任务

atd 服务和 `at` 命令用于执行一次性定时任务



### 用户权限设置

- 首先查询 /etc/at.allow 白名单文件，只有写入白名单中的用户才能使用 at ，没有在这个文件的用户则不能使用 at （即使没有写入 at.deny 黑名单文件中）。
- 如果 /etc/at.allow 文件不存在，则查找 /etc/at.deny 黑名单文件，写入黑名单文件的用户不能使用 at ，而没有在这个文件的用户则可以使用 at。
- 如果两个文件都不存在，那么只用 root 用户可以使用 at 命令。



推荐：

​	只设置白名单或只设置黑名单，不要混合设置；at.allow 是管理比较严格的方式， at.deny 的方式则比较宽松些，推荐只设置 at.deny 文件即可。



```

```



## 周期性计划任务

crontab 命令常用选项:

```shell
# 编辑crontab 任务内容
-e
# 查看crontab 任务内容
-l
# 删除crontab 全部任务内容
-r
```

语法:

crontab 命令包含【分、时、日、月、周、执行者、命令】7个字段的设置

| 表示含义 | 分   | 时   | 日   | 月   | 周   | 命令         |
| -------- | ---- | ---- | ---- | ---- | ---- | ------------ |
| 范围     | 0-59 | 0-23 | 0-31 | 1-12 | 0-7  | 需要执行命令 |

注: 单位周的0和7都表示星期天。

设置计划任务时需要一些特殊字符：

| 特殊字符 | 描述                                                         |
| -------- | ------------------------------------------------------------ |
| *        | 表示任何时刻都接受的意思; 0 12 * * * command 表示无论几号,几月,星期几,只要是12:00 就执行计划任务 |
| ,        | 并排列举时间; 0 3,6 * * * command 表示每天3:00 和 6:00 执行计划任务; |
| -        | 表示时间范围; 0 3-6 * * * command 表示每天的 3, 4, 5, 6 点执行计划任务; |
| /number  | 表示每隔n 个时间单位; */5 * * * command 表示每隔5分钟执行一次任务; |

示例:

```

```



